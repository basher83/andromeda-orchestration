# KICS Configuration for NetBox-Ansible Project
# Last Updated: 2025-07-27

# Scan specific paths for Ansible project
path: "."

# Platform types to scan - focused on Ansible and infrastructure
type:
  - Ansible
  - Dockerfile
  - Terraform
  - OpenAPI

# Exclude non-code and test directories
exclude-paths:
  - "docs/"
  - "tests/"
  - "molecule/"
  - "*.md"
  - "*.lock"
  - "renovate.json"
  - ".git/"
  - ".github/"
  - "kics-results/"
  - "reports/"
  - ".serena/"
  - "scripts/"
  - "__pycache__/"
  - "*.pyc"
  - ".pytest_cache/"
  - ".env"
  - ".venv/"
  - "venv/"

# Ansible-specific exclusions
exclude-categories:
  - "Best Practices"  # Can be noisy for Ansible patterns

# Query exclusions with explanations
exclude-queries:
  # Ignore healthcheck missing in test containers
  - "b03a748a-542d-44f4-bb86-9199ab4fd2d5"
  # Ignore missing user in molecule test dockerfiles
  - "fd54f200-402c-4333-a5a4-36ef6709af2f"
  # Ignore apt usage in test containers
  - "b84a0b47-2e99-4c9f-8933-98bcabe2b94d"
  # Ansible tasks often use become without specific user
  - "9b6b566f-9c1e-49d3-8139-4c336f1f2414"
  # Variable precedence is intentional in Ansible
  - "23ab4a67-8b04-4bbb-819d-4d2dca32c2c4"

# Exclude specific severities if needed (uncomment to use)
# exclude-severities:
#   - "INFO"
#   - "LOW"

# Output configuration
output-path: "/path/kics-results"
output-name: "results"
report-formats: "json,sarif,html"

# Logging configuration
log-file: true
log-path: "/path/kics-results/kics.log"
log-level: "INFO"

# Performance settings
no-progress: false
verbose: true

# Security-focused queries only (uncomment to enable)
# include-queries:
#   - "Security"
#   - "Secret Management"

# Secrets detection
secrets-regexes-path: ""  # Use default patterns

# Fail on specific severity levels (for CI/CD)
fail-on:
  - "HIGH"
  - "CRITICAL"

# Timeout for scan (in seconds)
timeout: 300
